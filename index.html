<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Santo Sex Shop - Tu Tienda √çntima de Confianza</title>
    <link rel="icon" href="./img/logo_1.png" type="image/png">
    <link rel="stylesheet" href="./css/style2.css" />

    <meta name="description"
        content="Santo Sex Shop - Tu tienda √≠ntima de confianza, con la mejor selecci√≥n de productos de calidad.">

    <!-- WhatsApp & Social Media Preview (Open Graph) -->
    <meta property="og:title" content="Santo Sex Shop ‚ù§Ô∏èüî•üòà">
    <meta property="og:description"
        content="Tu tienda √≠ntima de confianza en Rep√∫blica Dominicana. Encuentra la mejor selecci√≥n de productos er√≥ticos de calidad, con env√≠o discreto y seguro.">
    <meta property="og:image" content="https://santosexshop.com/logo_1.jpg">
    <meta property="og:url" content="https://santosexshop.com/">
    <meta property="og:type" content="website">

    <!-- Twitter Card Preview -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Santo Sex Shop ‚ù§Ô∏èüî•üòà">
    <meta name="twitter:description"
        content="Tu tienda √≠ntima de confianza en Rep√∫blica Dominicana. Productos er√≥ticos de calidad, env√≠o discreto y seguro.">
    <meta name="twitter:image" content="https://santosexshop.com/logo_1.jpg">

    <!-- SEO Meta -->
    <meta name="description"
        content="Santo Sex Shop - Tu tienda √≠ntima de confianza en Rep√∫blica Dominicana. Productos er√≥ticos de calidad con env√≠o discreto y seguro.">
    <meta name="author" content="Santo Sex Shop">
    <meta name="robots" content="index, follow">


    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Age Verification -->
    <div class="age-verification" id="ageVerification">
        <div class="age-modal">
            <h2>Verificaci√≥n de Edad</h2>
            <p style="margin: 1.5rem 0;">Este sitio contiene material para adultos. Debes ser mayor de 18 a√±os para
                continuar.</p>
            <button class="age-btn" onclick="confirmAge(true)">Soy mayor de 18</button>
            <button class="age-btn secondary" onclick="confirmAge(false)">Soy menor de 18</button>
        </div>
    </div>

    <!-- Bot√≥n flotante de WhatsApp -->
    <a href="https://wa.me/18296386767?text=Saludos,%20me%20gustar√≠a%20comunicarme%20con%20servicio%20al%20cliente."
        class="whatsapp-float" target="_blank" id="whatsappFloatBtn">
        <i class="fab fa-whatsapp"></i>
    </a>


    <!-- Bot√≥n de filtro fijo -->
    <div class="filter-toggle" id="filterToggle">
        <i class="fas fa-filter"></i>
    </div>

    <!-- Panel lateral de categor√≠as -->
    <div class="overlay" id="categoriesOverlay"></div>
    <div class="categories-panel" id="categoriesPanel">
        <div class="categories-header">
            <h3>Filtrar por Categor√≠a</h3>
            <button class="close-categories" id="closeCategories">&times;</button>
        </div>
        <ul class="categories-list" id="categoriesList">
            <div class="loading">
                <div class="spinner"></div>
                <div>Cargando categor√≠as...</div>
            </div>
        </ul>
    </div>


    <div class="Box-Master">

        <!-- Header -->
        <header>
            <video autoplay loop muted playsinline class="video-fondo">
                <source src="./img/vid/33090-395456658_small.mp4" type="video/mp4">
                Tu navegador no soporta el video.
            </video>

            <div class="container">

                <div class="header-content">
                    <div class="logo"><img src="./img/logo_1.png">
                        <div class="tex-background">
                            <h2 id="titleanim" style="font-size: 1.5rem;">Santo Sex Shop</h2>
                        </div>
                    </div>
                </div>

                <div class="social-icon">
                    <button><img src="./img/icons/Instagram_logo_1.svg"><a
                            href="https://www.instagram.com/santo.sex.shop?igsh=dnNxamNoaWRxZmVp"
                            target="_blank"></a></button>
                </div>
            </div>
        </header>



        <div class="content-master">
            <!-- Hero Section -->
            <section class="hero">
                <div class="line01"></div>
                <h1>Bienvenidos</h1>
                <p><strong>Santo Sex Shop</strong> - Tu tienda √≠ntima de confianza, con la mejor selecci√≥n de productos
                    de
                    calidad.</p>
            </section>

            <!-- Secci√≥n de textos din√°micos -->
            <section class="dynamic-text-section">
                <div class="dynamic-text-container" id="dynamicTextContainer">
                    <div class="dynamic-texts-wrapper" id="dynamicTextsWrapper">
                        <div class="dynamic-text">Env√≠os 100% discretos üööüì¶ | Calidad garantizada üíØ | Atenci√≥n
                            personalizada üí¨</div>
                        <div class="dynamic-text">¬°Aceptamos todas las tarjetas de cr√©dito! üí≥
                        </div>
                        <div class="dynamic-text">Somos tienda f√≠sica y virtual.
                        </div>
                        <div class="dynamic-text">Env√≠os a todas partes del pa√≠s.</div>
                        <div class="dynamic-text">Porque tu placer y tu privacidad son nuestra prioridad ‚ù§Ô∏è‚Äçüî•üîí</div>

                    </div>
                </div>
                <div class="dynamic-indicators" id="dynamicIndicators">
                    <!-- Los indicadores se generar√°n con JavaScript -->
                </div>
            </section>

            <!-- Nueva secci√≥n de productos destacados -->
            <section class="featured-section">

                <h2 class="featured-title">Productos Destacados üëë</h2>

                <div class="featured-products-container">
                    <div class="featured-products-track" id="featuredProductsTrack">
                        <!-- Los productos destacados se cargar√°n aqu√≠ -->
                    </div>
                </div>
            </section>

            <!-- Products Section -->
            <section class="products-section">
                <h2 class="section-title">Nuestros Productos</h2>

                <!-- Secci√≥n de categor√≠as y productos -->
                <div id="categoriesProductsContainer">
                    <!-- Las categor√≠as con sus productos se cargar√°n aqu√≠ -->
                    <div class="loading">
                        <div class="spinner"></div>
                        <div>Cargando productos...</div>
                    </div>
                </div>
            </section>
        </div>




        <div class="prev-info-down">
            <div class="division"></div>

            <p>La discreci√≥n es nuestra prioridad ü§´. Env√≠os a todas partes del pa√≠s üá©üá¥. Aceptamos todas las tarjetas de cr√©dito y d√©bito üí≥.</p>
        </div>

<div class="info-down">
    <div class="background-down">
        <img src="./img/2T-Elvis Sex Shop Logo777.png">
    </div>
   <div class="info-mini-redes">
        <h6>S√≠guenos:</h6>
        <div style="position: relative; display:inline-block; margin-right:10px;">
            <img src="./img/icons/Instagram_logo_1.svg" alt="Instagram" style="width:25px; height:25px;">
            <a href="https://www.instagram.com/santo.sex.shop?igsh=dnNxamNoaWRxZmVp" target="_blank" style="position: absolute;top: 0;left: 0;height: 100%;width: 100%;"></a>
        </div>
        <!-- Texto debajo -->
        <div class="contacto" style="margin-top:10px;text-align:center;display: flex;flex-direction: column;font-family: sans-serif;font-weight: 100;color: #b9b9b9;">
            <p style="margin:0;font-weight:bold;font-weight: 100;">Escr√≠benos o ll√°manos:</p>
            <a href="tel:+18296386767" style="color:#e60073; font-size:16px; font-weight:bold; text-decoration:none;">
            (829) 638-6767
            </a>
        </div>
    </div>
</div>


        <!-- Footer -->
        <footer>
            <div class="container footer">
                <p>&copy; 2025 Santo Sex Shop. Todos los derechos reservados.<br>Desarrollado por Jos√© Polanco.</p>
            </div>
        </footer>





    </div>

    <!-- Product Modal -->
    <div class="modal" id="productModal">
        <div class="modal-content">
            <div class="modal-title">
                <h3 id="modalProductName">Producto</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div class="modal-product-gallery" id="modalProductGallery">
                    <div class="gallery-main">
                        <img id="galleryMainImage" src="" alt="Product image">
                        <button class="gallery-nav gallery-prev" onclick="changeImage(-1)">&#10094;</button>
                        <button class="gallery-nav gallery-next" onclick="changeImage(1)">&#10095;</button>
                    </div>

                    <div class="gallery-thumbnails" id="galleryThumbnails">
                        <!-- Las miniaturas se agregar√°n aqu√≠ -->
                    </div>
                </div>

               <div class="modal-product-info">
    <div>
        <div class="division2" style="margin-bottom: 14px;"></div>
        <div class="product-name-header">Producto:</div>
        <div id="modalProductName2" class="product-name"></div>
        <div id="modalProductPrice" class="product-price">RD$0</div>
        <div class="product-description-header">Descripci√≥n:</div>
        <!-- CAMBIO AQU√ç: Agregar clase y mejor estructura -->
        <div id="modalProductDescription" class="product-description html-content" style="white-space: pre-line; line-height: 1.5; margin-top: 8px;"></div>
        <div class="division2" style="margin-bottom: 14px;"></div>
        <div class="info-general">
La discreci√≥n es nuestra prioridad ü§´. Env√≠os a todas partes del pa√≠s üá©üá¥. Aceptamos todas las tarjetas de cr√©dito y d√©bito üí≥.
        </div>
    </div>
</div>
            </div>

            <div class="modal-footer">
                <a href="#" class="whatsapp-btn" id="whatsappBtn">
                    <i class="fab fa-whatsapp" style="font-size: 1.8rem;"></i>
                    Pedir por WhatsApp
                </a>
            </div>
        </div>
    </div>



    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCWGop8_AWv52SuXHP5loh-caH67waFcJw",
            authDomain: "santo-shop-ecdc1.firebaseapp.com",
            projectId: "santo-shop-ecdc1",
            storageBucket: "santo-shop-ecdc1.firebasestorage.app",
            messagingSenderId: "427918393457",
            appId: "1:427918393457:web:c73dcd63c32786f07a9bd0"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Global variables
        let categories = [];
        let products = [];
        const whatsappNumber = "+18296386767"; // N√∫mero de WhatsApp actualizado

        // Variables para la galer√≠a de im√°genes
        let currentProductImages = [];
        let currentImageIndex = 0;

        // Variables para el carrusel de textos
        let currentTextIndex = 0;
        let textInterval;
        let startX, currentX;
        let isDragging = false;

        // Funci√≥n para formatear precios en formato RD$
        function formatPrice(price) {
            // Convertir a n√∫mero si es string
            const numPrice = typeof price === 'string' ? parseFloat(price) : price;

            // Formatear con separadores de miles y decimales
            return `RD$${numPrice.toLocaleString('es-DO', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            })}`;
        }

        // Age verification - SIEMPRE muestra el modal
        function confirmAge(isAdult) {
            if (isAdult) {
                document.getElementById('ageVerification').style.display = 'none';
                // No guardar en sessionStorage para que siempre aparezca
            } else {
                window.location.href = 'https://www.google.com';
            }
        }

        // Toggle categories panel
        function toggleCategoriesPanel() {
            const panel = document.getElementById('categoriesPanel');
            const overlay = document.getElementById('categoriesOverlay');

            panel.classList.toggle('open');
            overlay.style.display = panel.classList.contains('open') ? 'block' : 'none';
        }

        // Close categories panel
        function closeCategoriesPanel() {
            document.getElementById('categoriesPanel').classList.remove('open');
            document.getElementById('categoriesOverlay').style.display = 'none';
        }

        // Load categories from Firestore
async function loadCategories() {
    try {
        const snapshot = await db.collection('categoria').get();
        categories = snapshot.docs.map(doc => ({
            id: doc.id,
            ...doc.data()
        }));

        displayCategories();
    } catch (error) {
        console.error('Error loading categories:', error);
        // Fallback categories for demo - agregar positionOrder a las categor√≠as de ejemplo
        categories = [
            { id: '1', nombre: 'Juguetes', icono: 'fas fa-dice', positionOrder: 1 },
            { id: '2', nombre: 'Lencer√≠a', icono: 'fas fa-tshirt', positionOrder: 2 },
            { id: '3', nombre: 'Aceites', icono: 'fas fa-flask', positionOrder: 3 },
            { id: '4', nombre: 'Preservativos', icono: 'fas fa-shield-alt', positionOrder: 4 }
        ];
        displayCategories();
    }
}

        // Display categories in the side panel
        // Display categories in the side panel
        function displayCategories() {
            const list = document.getElementById('categoriesList');

            // Add "Todos" category
            const allCategory = {
                id: 'all',
                nombre: 'Todos los Productos',
                icono: 'fas fa-th-large',
                count: products.length // Total de todos los productos
            };

            // Crear array de categor√≠as con su conteo de productos
            const categoriesToShow = [allCategory];

            categories.forEach(category => {
                const categoryProducts = products.filter(product => product.categoria === category.id);
                categoriesToShow.push({
                    ...category,
                    count: categoryProducts.length
                });
            });

            list.innerHTML = categoriesToShow.map(category => `
        <li class="category-item" onclick="filterByCategory('${category.id}')">
            <span><i class="${category.icono}"></i> ${category.nombre}</span>
            <span class="product-count" id="count-${category.id}">${category.count}</span>
        </li>
    `).join('');
        }

        // Load products from Firestore
        async function loadProducts() {
            try {
                const snapshot = await db.collection('productos').get();
                products = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                // Actualizar las categor√≠as con los conteos de productos
                displayCategories();
                displayProductsByCategory();
            } catch (error) {
                console.error('Error loading products:', error);
                // Fallback products for demo
                products = [
                    {
                        id: '1',
                        nombre: 'Producto Ejemplo 1',
                        precio: 29.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 1. Fabricado con materiales de alta calidad.',
                        categoria: '1',
                        icono: 'https://via.placeholder.com/200x200/667eea/white?text=Producto+1',
                        imagenes: [
                            'https://via.placeholder.com/600x600/667eea/white?text=Imagen+1',
                            'https://via.placeholder.com/600x600/764ba2/white?text=Imagen+2',
                            'https://via.placeholder.com/600x600/e91e63/white?text=Imagen+3'
                        ]
                    },
                    {
                        id: '2',
                        nombre: 'Producto Ejemplo 2',
                        precio: 45.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 2. Ideal para principiantes.',
                        categoria: '2',
                        icono: 'https://via.placeholder.com/200x200/764ba2/white?text=Producto+2',
                        imagenes: [
                            'https://via.placeholder.com/600x600/764ba2/white?text=Imagen+1',
                            'https://via.placeholder.com/600x600/e91e63/white?text=Imagen+2'
                        ]
                    },
                    {
                        id: '3',
                        nombre: 'Producto Ejemplo 3',
                        precio: 19.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 3. F√≥rmula natural y segura.',
                        categoria: '3',
                        icono: 'https://via.placeholder.com/200x200/e91e63/white?text=Producto+3',
                        imagenes: [
                            'https://via.placeholder.com/600x600/e91e63/white?text=Imagen+1'
                        ]
                    },
                    {
                        id: '4',
                        nombre: 'Producto Ejemplo 4',
                        precio: 39.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 4. Dise√±o ergon√≥mico.',
                        categoria: '1',
                        icono: 'https://via.placeholder.com/200x200/9c27b0/white?text=Producto+4',
                        imagenes: [
                            'https://via.placeholder.com/600x600/9c27b0/white?text=Imagen+1'
                        ]
                    },
                    {
                        id: '5',
                        nombre: 'Producto Ejemplo 5',
                        precio: 49.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 5. Material premium.',
                        categoria: '1',
                        icono: 'https://via.placeholder.com/200x200/ff9800/white?text=Producto+5',
                        imagenes: [
                            'https://via.placeholder.com/600x600/ff9800/white?text=Imagen+1'
                        ]
                    },
                    {
                        id: '6',
                        nombre: 'Producto Ejemplo 6',
                        precio: 59.99,
                        descripcion: 'Descripci√≥n detallada del producto ejemplo 6. Tecnolog√≠a avanzada.',
                        categoria: '1',
                        icono: 'https://via.placeholder.com/200x200/4caf50/white?text=Producto+6',
                        imagenes: [
                            'https://via.placeholder.com/600x600/4caf50/white?text=Imagen+1'
                        ]
                    }
                ];
                displayCategories();
                displayProductsByCategory();
            }
        }

        // Funci√≥n para cargar y mostrar productos destacados
        async function loadFeaturedProducts() {
            try {
                const snapshot = await db.collection('productos')
                    .where('destacado', '==', 'yes')
                    .get();

                const featuredProducts = snapshot.docs.map(doc => ({
                    id: doc.id,
                    ...doc.data()
                }));

                displayFeaturedProducts(featuredProducts);
            } catch (error) {
                console.error('Error loading featured products:', error);
                // Mostrar mensaje si no hay productos destacados
                document.getElementById('featuredProductsTrack').innerHTML = `
                    <div class="no-featured">
                        No hay productos destacados en este momento
                    </div>
                `;
            }
        }

        // Mostrar productos destacados con animaci√≥n infinita
        function displayFeaturedProducts(products) {
            const container = document.getElementById('featuredProductsTrack');

            if (products.length === 0) {
                container.innerHTML = `
                    <div class="no-featured">
                        No hay productos destacados en este momento
                    </div>
                `;
                return;
            }

            // Crear HTML para los productos
            const productsHTML = products.map(product => `
                <div class="featured-product-card" onclick="openProductModal('${product.id}')">
                    <div class="featured-product-image">
                        <img src="${product.icono}" alt="${product.nombre}">
                        <div class="shadow-img"></div>
                    </div>
                    <div class="featured-product-info">
                        <h4 class="featured-product-name">${product.nombre}</h4>
                        <h3 class="featured-product-description">${product.descripcion}</h3>
                        <div class="featured-product-price">${formatPrice(product.precio)}</div>
                    </div>
                </div>
            `).join('');

            // Duplicar los productos para crear el efecto de scroll infinito
            container.innerHTML = productsHTML + productsHTML;
        }

        // Mostrar productos organizados por categor√≠as (SOLO CATEGOR√çAS REALES)
      function displayProductsByCategory() {
    const container = document.getElementById('categoriesProductsContainer');

    let html = '';

    // Ordenar categor√≠as por positionOrder (de menor a mayor)
    const sortedCategories = [...categories].sort((a, b) => {
        // Si no tiene positionOrder, ponerlo al final
        const orderA = a.positionOrder || 9999;
        const orderB = b.positionOrder || 9999;
        return orderA - orderB;
    });

    // Solo mostrar categor√≠as reales, no incluir "Todos"
    sortedCategories.forEach(category => {
        // Filtrar productos por categor√≠a
        const categoryProducts = products.filter(product => product.categoria === category.id);

        if (categoryProducts.length === 0) return;

        // Determinar si mostrar el bot√≥n "Mostrar Todo"
        const showAllButton = categoryProducts.length > 5 ?
            `<button class="show-all-btn" onclick="toggleShowAll('${category.id}')">
                Ver todo <span class="product-count-badge">${categoryProducts.length}</span>
            </button>` : '';

        // Limitar a m√°ximo 5 productos para vista inicial
        const limitedProducts = categoryProducts.slice(0, 5);

        html += `
            <div class="category-section">
                <div class="category-header">
                    <h3 class="category-title">${category.nombre}</h3>
                    ${showAllButton}
                </div>
                <div class="category-products-container">
                    <button class="category-nav prev hidden" onclick="scrollCategoryProducts(this, -1)">&#10094;</button>
                    <div class="category-products" id="category-${category.id}">
                        ${limitedProducts.map(product => `
                            <div class="product-card" onclick="openProductModal('${product.id}')">
                                <div class="product-image">
                                    <img src="${product.icono}" alt="${product.nombre}">
                                    <div class="shadow-img"></div>
                                </div>
                                <div class="product-info">
                                    <h4 class="product-name">${product.nombre}</h4>
                                    <div class="product-description">${product.descripcion}</div>
                                    <div class="product-price">${formatPrice(product.precio)}</div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    <button class="category-nav next" onclick="scrollCategoryProducts(this, 1)">&#10095;</button>
                </div>
            </div>
        `;
    });

    container.innerHTML = html;

    // Inicializar navegaci√≥n de flechas para cada categor√≠a
    initCategoryNavigation();
}

        // Funci√≥n para mostrar/ocultar todos los productos de una categor√≠a
        function toggleShowAll(categoryId) {
            const categoryProductsContainer = document.getElementById(`category-${categoryId}`);
            const categoryProducts = products.filter(product => product.categoria === categoryId);
            const showAllButton = categoryProductsContainer.closest('.category-section').querySelector('.show-all-btn');

            if (categoryProductsContainer.classList.contains('expanded')) {
                // Volver a la vista limitada (m√°ximo 5 productos)
                const limitedProducts = categoryProducts.slice(0, 5);

                categoryProductsContainer.innerHTML = limitedProducts.map(product => `
            <div class="product-card" onclick="openProductModal('${product.id}')">
                <div class="product-image">
                    <img src="${product.icono}" alt="${product.nombre}">
                    <div class="shadow-img"></div>
                </div>
                <div class="product-info">
                    <h4 class="product-name">${product.nombre}</h4>
                    <div class="product-description">${product.descripcion}</div>
                    <div class="product-price">${formatPrice(product.precio)}</div>
                </div>
            </div>
        `).join('');

                categoryProductsContainer.classList.remove('expanded');
                showAllButton.innerHTML = `Ver todo <span class="product-count-badge">${categoryProducts.length}</span>`;

                // Re-inicializar navegaci√≥n con flechas
                initCategoryNavigationForCategory(categoryId);
            } else {
                // Mostrar todos los productos en grid
                categoryProductsContainer.innerHTML = categoryProducts.map(product => `
            <div class="product-card" onclick="openProductModal('${product.id}')">
                <div class="product-image">
                    <img src="${product.icono}" alt="${product.nombre}">
                    <div class="shadow-img"></div>
                </div>
                <div class="product-info">
                    <h4 class="product-name">${product.nombre}</h4>
                    <div class="product-description">${product.descripcion}</div>
                    <div class="product-price">${formatPrice(product.precio)}</div>
                </div>
            </div>
        `).join('');

                categoryProductsContainer.classList.add('expanded');
                showAllButton.innerHTML = `Ver menos <span class="product-count-badge">${categoryProducts.length}</span>`;
            }
        }

        // Reinicializar navegaci√≥n para una categor√≠a espec√≠fica
        function initCategoryNavigationForCategory(categoryId) {
            const container = document.getElementById(`category-${categoryId}`).closest('.category-products-container');
            const productsElement = container.querySelector('.category-products');
            const prevButton = container.querySelector('.prev');
            const nextButton = container.querySelector('.next');

            if (productsElement && !productsElement.classList.contains('expanded')) {
                productsElement.addEventListener('scroll', () => {
                    updateNavButtons(productsElement, prevButton, nextButton);
                });

                updateNavButtons(productsElement, prevButton, nextButton);
            }
        }

        // Inicializar navegaci√≥n con flechas para categor√≠as
        function initCategoryNavigation() {
            const categoryContainers = document.querySelectorAll('.category-products-container');

            categoryContainers.forEach(container => {
                const productsElement = container.querySelector('.category-products');
                const prevButton = container.querySelector('.prev');
                const nextButton = container.querySelector('.next');

                // Mostrar/ocultar flechas seg√∫n el scroll
                productsElement.addEventListener('scroll', () => {
                    updateNavButtons(productsElement, prevButton, nextButton);
                });

                // Verificar estado inicial
                updateNavButtons(productsElement, prevButton, nextButton);
            });
        }

        // Actualizar estado de botones de navegaci√≥n
        function updateNavButtons(productsElement, prevButton, nextButton) {
            const scrollLeft = productsElement.scrollLeft;
            const maxScrollLeft = productsElement.scrollWidth - productsElement.clientWidth;

            // Mostrar u ocultar botones seg√∫n la posici√≥n del scroll
            if (scrollLeft <= 10) {
                prevButton.classList.add('hidden');
            } else {
                prevButton.classList.remove('hidden');
            }

            if (scrollLeft >= maxScrollLeft - 10) {
                nextButton.classList.add('hidden');
            } else {
                nextButton.classList.remove('hidden');
            }
        }

        // Funci√≥n para desplazar el carrusel de productos
        function scrollCategoryProducts(button, direction) {
            const container = button.closest('.category-products-container');
            const productsElement = container.querySelector('.category-products');
            const scrollAmount = 300; // Cantidad de desplazamiento

            productsElement.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }

        // Filtrar productos por categor√≠a
        function filterByCategory(categoryId) {
    const container = document.getElementById('categoriesProductsContainer');

    if (categoryId === 'all') {
        // Mostrar todos los productos organizados por categor√≠a, ordenados por positionOrder
        displayProductsByCategory();
    } else {
        // Filtrar productos por categor√≠a espec√≠fica
        const filteredProducts = products.filter(product => product.categoria === categoryId);

        if (filteredProducts.length === 0) {
            container.innerHTML = `
                <div class="no-products">
                    <i class="fas fa-box-open"></i>
                    <p>No hay productos en esta categor√≠a</p>
                </div>
            `;
        } else {
            // Determinar si mostrar el bot√≥n "Mostrar Todo"
            const showAllButton = filteredProducts.length > 5 ?
                `<button class="show-all-btn" onclick="toggleShowAll('${categoryId}')">
                    Ver todo <span class="product-count-badge">${filteredProducts.length}</span>
                </button>` : '';

            // Limitar a m√°ximo 5 productos para vista inicial
            const limitedProducts = filteredProducts.slice(0, 5);

            const category = categories.find(cat => cat.id === categoryId);

            container.innerHTML = `
                <div class="category-section">
                    <div class="category-header">
                        <h3 class="category-title">${category.nombre}</h3>
                        ${showAllButton}
                    </div>
                    <div class="category-products-container">
                        <button class="category-nav prev hidden" onclick="scrollCategoryProducts(this, -1)">&#10094;</button>
                        <div class="category-products" id="category-${categoryId}">
                            ${limitedProducts.map(product => `
                                <div class="product-card" onclick="openProductModal('${product.id}')">
                                    <div class="product-image">
                                        <img src="${product.icono}" alt="${product.nombre}">
                                        <div class="shadow-img"></div>
                                    </div>
                                    <div class="product-info">
                                        <h4 class="product-name">${product.nombre}</h4>
                                        <div class="product-description">${product.descripcion}</div>
                                        <div class="product-price">${formatPrice(product.precio)}</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        <button class="category-nav next" onclick="scrollCategoryProducts(this, 1)">&#10095;</button>
                    </div>
                </div>
            `;

            // Inicializar navegaci√≥n para esta categor√≠a
            initCategoryNavigationForCategory(categoryId);
        }
    }

    closeCategoriesPanel();
}

        // Abrir modal de producto
     // Abrir modal de producto
function openProductModal(productId) {
    const product = products.find(p => p.id === productId);
    if (!product) return;

    const modal = document.getElementById('productModal');
    const modalContent = modal.querySelector('.modal-content');
    const modalName = document.getElementById('modalProductName');
    const modalName2 = document.getElementById('modalProductName2');
    const modalPrice = document.getElementById('modalProductPrice');
    const modalDescription = document.getElementById('modalProductDescription');
    const whatsappBtn = document.getElementById('whatsappBtn');

    // Remover clase de cierre si existe
    modalContent.classList.remove('closing');

    // Actualizar informaci√≥n del producto
    modalName.textContent = product.nombre;
    modalName2.textContent = product.nombre;
    modalPrice.textContent = formatPrice(product.precio);
    
    // MEJORA: Manejar descripci√≥n vac√≠a y asegurar formato correcto
    const description = product.descripcion || 'Descripci√≥n no disponible en este momento.';
    
    // Limpiar y formatear correctamente la descripci√≥n
    modalDescription.innerHTML = description
        .replace(/\n/g, '<br>') // Convertir saltos de l√≠nea a <br>
        .replace(/\s+/g, ' ')   // Normalizar espacios
        .trim();

    // Configurar enlace de WhatsApp con URL del producto
    const productUrl = `${window.location.origin}${window.location.pathname}?product=${productId}`;
    const message = `Saludos, me interesa el producto: ${productUrl}`;
    const encodedMessage = encodeURIComponent(message);
    whatsappBtn.href = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;

    // Configurar galer√≠a de im√°genes
    setupProductGallery(product);

    // Mostrar modal
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';

    // MEJORA: Forzar reflow para asegurar que los estilos se apliquen correctamente
    setTimeout(() => {
        modalDescription.style.display = 'none';
        modalDescription.offsetHeight; // Trigger reflow
        modalDescription.style.display = 'block';
    }, 10);
}


        // Funci√≥n para abrir producto desde URL
        function openProductFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('product');

            if (productId) {
                // Esperar a que los productos est√©n cargados
                const checkProductLoaded = setInterval(() => {
                    if (products.length > 0) {
                        clearInterval(checkProductLoaded);
                        const product = products.find(p => p.id === productId);
                        if (product) {
                            openProductModal(productId);

                            // Limpiar la URL sin recargar la p√°gina
                            const newUrl = window.location.origin + window.location.pathname;
                            window.history.replaceState({}, document.title, newUrl);
                        }
                    }
                }, 100);
            }
        }



        // Configurar galer√≠a de im√°genes del producto
        function setupProductGallery(product) {
            const galleryMainImage = document.getElementById('galleryMainImage');
            const galleryThumbnails = document.getElementById('galleryThumbnails');

            // Guardar im√°genes del producto actual
            currentProductImages = product.imagenes || [product.icono];
            currentImageIndex = 0;

            // Mostrar primera imagen
            galleryMainImage.src = currentProductImages[0];

            // Crear miniaturas
            galleryThumbnails.innerHTML = currentProductImages.map((img, index) => `
                <div class="gallery-thumbnail ${index === 0 ? 'active' : ''}" onclick="setCurrentImage(${index})">
                    <img src="${img}" alt="Miniatura ${index + 1}">
                </div>
            `).join('');
        }

        // Cambiar imagen en la galer√≠a
        function changeImage(direction) {
            currentImageIndex += direction;

            // Verificar l√≠mites
            if (currentImageIndex < 0) {
                currentImageIndex = currentProductImages.length - 1;
            } else if (currentImageIndex >= currentProductImages.length) {
                currentImageIndex = 0;
            }

            setCurrentImage(currentImageIndex);
        }

        // Establecer imagen actual
        function setCurrentImage(index) {
            const galleryMainImage = document.getElementById('galleryMainImage');
            const thumbnails = document.querySelectorAll('.gallery-thumbnail');

            // Actualizar √≠ndice
            currentImageIndex = index;

            // Cambiar imagen principal
            galleryMainImage.src = currentProductImages[index];

            // Actualizar miniaturas activas
            thumbnails.forEach((thumb, i) => {
                if (i === index) {
                    thumb.classList.add('active');
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Cerrar modal
        // Cerrar modal con animaci√≥n
        function closeModal() {
            const modal = document.getElementById('productModal');
            const modalContent = modal.querySelector('.modal-content');

            // Agregar clase para animaci√≥n de salida
            modalContent.classList.add('closing');

            // Esperar a que termine la animaci√≥n antes de ocultar el modal
            setTimeout(() => {
                modal.style.display = 'none';
                modalContent.classList.remove('closing');
                document.body.style.overflow = 'auto';
            }, 300); // Debe coincidir con la duraci√≥n de la animaci√≥n (0.3s = 300ms)
        }

        // Modificar el evento de clic fuera del modal para usar la animaci√≥n
        document.getElementById('productModal').addEventListener('click', function (e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Modificar el evento de tecla Escape para usar la animaci√≥n
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // Inicializar textos din√°micos
        function initDynamicTexts() {
            const wrapper = document.getElementById('dynamicTextsWrapper');
            const indicators = document.getElementById('dynamicIndicators');
            const texts = wrapper.querySelectorAll('.dynamic-text');
            const totalTexts = texts.length;

            // Crear indicadores
            indicators.innerHTML = Array.from({ length: totalTexts }, (_, i) =>
                `<span class="indicator ${i === 0 ? 'active' : ''}" onclick="goToText(${i})"></span>`
            ).join('');

            // Configurar animaci√≥n autom√°tica
            textInterval = setInterval(() => {
                currentTextIndex = (currentTextIndex + 1) % totalTexts;
                updateTextPosition();
            }, 5000);

            // Configurar eventos t√°ctiles para deslizar
            wrapper.addEventListener('touchstart', handleTouchStart, false);
            wrapper.addEventListener('touchmove', handleTouchMove, false);
            wrapper.addEventListener('touchend', handleTouchEnd, false);
        }

        // Manejar inicio de toque
        function handleTouchStart(e) {
            startX = e.touches[0].clientX;
            isDragging = true;
            clearInterval(textInterval); // Pausar animaci√≥n autom√°tica
        }

        // Manejar movimiento de toque
        function handleTouchMove(e) {
            if (!isDragging) return;
            currentX = e.touches[0].clientX;
        }

        // Manejar fin de toque
        function handleTouchEnd() {
            if (!isDragging) return;

            const diffX = startX - currentX;
            const threshold = 50; // M√≠nimo desplazamiento para cambiar texto

            if (Math.abs(diffX) > threshold) {
                if (diffX > 0) {
                    // Deslizamiento hacia izquierda - siguiente texto
                    currentTextIndex = (currentTextIndex + 1) % document.querySelectorAll('.dynamic-text').length;
                } else {
                    // Deslizamiento hacia derecha - texto anterior
                    currentTextIndex = (currentTextIndex - 1 + document.querySelectorAll('.dynamic-text').length) % document.querySelectorAll('.dynamic-text').length;
                }
                updateTextPosition();
            }

            isDragging = false;

            // Reanudar animaci√≥n autom√°tica despu√©s de 5 segundos
            textInterval = setInterval(() => {
                currentTextIndex = (currentTextIndex + 1) % document.querySelectorAll('.dynamic-text').length;
                updateTextPosition();
            }, 5000);
        }

        // Ir a texto espec√≠fico
        function goToText(index) {
            currentTextIndex = index;
            updateTextPosition();
            clearInterval(textInterval);

            // Reanudar animaci√≥n autom√°tica despu√©s de 5 segundos
            textInterval = setInterval(() => {
                currentTextIndex = (currentTextIndex + 1) % document.querySelectorAll('.dynamic-text').length;
                updateTextPosition();
            }, 5000);
        }

        // Actualizar posici√≥n del texto
        function updateTextPosition() {
            const wrapper = document.getElementById('dynamicTextsWrapper');
            const indicators = document.querySelectorAll('.indicator');

            // Mover el wrapper
            wrapper.style.transform = `translateX(-${currentTextIndex * 100}%)`;

            // Actualizar indicadores
            indicators.forEach((indicator, i) => {
                if (i === currentTextIndex) {
                    indicator.classList.add('active');
                } else {
                    indicator.classList.remove('active');
                }
            });
        }

        // Inicializar aplicaci√≥n
        document.addEventListener('DOMContentLoaded', async function () {
            // Cargar categor√≠as y productos
            await loadCategories();
            await loadProducts();
            await loadFeaturedProducts();

            // Inicializar textos din√°micos
            initDynamicTexts();

            // Configurar eventos
            document.getElementById('filterToggle').addEventListener('click', toggleCategoriesPanel);
            document.getElementById('closeCategories').addEventListener('click', closeCategoriesPanel);
            document.getElementById('categoriesOverlay').addEventListener('click', closeCategoriesPanel);

            // Cerrar modal al hacer clic fuera del contenido
            document.getElementById('productModal').addEventListener('click', function (e) {
                if (e.target === this) {
                    closeModal();
                }
            });

            // Cerrar modal con tecla Escape
            document.addEventListener('keydown', function (e) {
                if (e.key === 'Escape') {
                    closeModal();
                }
            });

            // Configurar bot√≥n flotante de WhatsApp
            const whatsappBtn = document.getElementById('whatsappFloatBtn');
            if (whatsappBtn) {
                whatsappBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    window.open(this.href, '_blank');
                });
            }

            // Verificar si hay un producto en la URL al cargar la p√°gina
            openProductFromURL();
        });

        // Tambi√©n verificar cuando cambia la URL (por si acaso)
        window.addEventListener('popstate', openProductFromURL);
    </script>
</body>

</html>